<!doctype html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WinRAR SFX Installer ‚Äî Tutorial</title>
  <meta name="description" content="Official-style guide to building a self-extracting (SFX) installer with WinRAR using Tailwind CSS, including shortcut creation and optional auto-launch." />

  <!-- Prevent theme flash -->
  <script>
    (function(){
      try{
        var t = localStorage.getItem('theme');
        if(t === 'light') document.documentElement.classList.remove('dark');
        else if(t === 'dark') document.documentElement.classList.add('dark');
        else if(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches){
          document.documentElement.classList.add('dark');
        }
      }catch(e){}
    })();
  </script>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: { sans: ['Inter','ui-sans-serif','system-ui','Segoe UI','Roboto','Helvetica','Arial'] }
        }
      }
    }
  </script>
</head>
<body class="bg-white text-slate-800 dark:bg-slate-950 dark:text-slate-100 antialiased">

  <!-- HEADER (identical layout/classes to Color Tag Generator) -->
  <header class="sticky top-0 z-40 bg-white/70 dark:bg-slate-950/70 backdrop-blur border-b border-slate-200/70 dark:border-slate-800/70">
    <div class="mx-auto max-w-[1080px] w-full px-4 md:px-6 lg:px-8">
      <div class="h-14 flex items-center justify-between">
        <h1 class="text-base md:text-lg font-extrabold tracking-tight">üóúÔ∏è WinRAR SFX Installer</h1>
        <div class="flex items-center gap-2">
          <a href="/" class="hidden sm:inline-block text-sm font-semibold px-3 py-2 rounded-lg hover:bg-slate-950/5 dark:hover:bg-white/5">Home</a>
          <!-- Theme toggle -->
          <button id="themeToggle" class="inline-flex items-center justify-center h-9 w-9 rounded-lg ring-1 ring-slate-200 dark:ring-slate-800 hover:bg-slate-950/5 dark:hover:bg-white/5" title="Toggle theme">
            <!-- sun (shows in dark) -->
            <svg class="h-5 w-5 hidden dark:block" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="4"></circle>
              <path d="M12 2v2m0 16v2m10-10h-2M4 12H2m16.95 6.95-1.41-1.41M6.46 6.46 5.05 5.05m13.49 0-1.41 1.41M6.46 17.54l-1.41 1.41"/>
            </svg>
            <!-- moon (shows in light) -->
            <svg class="h-5 w-5 dark:hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main class="mx-auto max-w-[1080px] w-full px-4 md:px-6 lg:px-8 py-8 pb-16">

    <!-- Hero -->
    <section class="rounded-2xl border border-slate-200 dark:border-slate-800 bg-gradient-to-tr from-sky-500/10 to-transparent p-6 md:p-8 mb-6">
      <h1 class="text-2xl md:text-3xl font-bold tracking-tight">WinRAR Self-Extracting (SFX) Installer</h1>
      <p class="mt-2 text-slate-600 dark:text-slate-400">Package an application into a single <span class="font-semibold">.exe</span> using WinRAR SFX, including a post-install script to create shortcuts and optionally launch the app.</p>
      <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-2 mt-4">
        <a href="#requirements" class="block rounded-xl border border-slate-200 dark:border-slate-800 px-3 py-2 hover:border-sky-400">1) Requirements</a>
        <a href="#structure" class="block rounded-xl border border-slate-200 dark:border-slate-800 px-3 py-2 hover:border-sky-400">2) Prepare Folder</a>
        <a href="#vbs" class="block rounded-xl border border-slate-200 dark:border-slate-800 px-3 py-2 hover:border-sky-400">3) Shortcut Script (VBS)</a>
        <a href="#build" class="block rounded-xl border border-slate-200 dark:border-slate-800 px-3 py-2 hover:border-sky-400">4) Build SFX</a>
        <a href="#test" class="block rounded-xl border border-slate-200 dark:border-slate-800 px-3 py-2 hover:border-sky-400">5) Test</a>
        <a href="#troubleshoot" class="block rounded-xl border border-slate-200 dark:border-slate-800 px-3 py-2 hover:border-sky-400">6) Troubleshooting</a>
        <a href="#notes" class="block rounded-xl border border-slate-200 dark:border-slate-800 px-3 py-2 hover:border-sky-400">7) Notes & Options</a>
        <a href="#checklist" class="block rounded-xl border border-slate-200 dark:border-slate-800 px-3 py-2 hover:border-sky-400">8) Checklist</a>
      </div>
    </section>

    <!-- Requirements -->
    <section id="requirements" class="mt-8">
      <h2 class="text-xl font-semibold">1) Requirements</h2>
      <ul class="mt-2 list-disc list-inside space-y-1 text-slate-700 dark:text-slate-300">
        <li>WinRAR (latest version recommended)</li>
        <li>Application folder (contains the main executable, e.g., <code class="font-mono">AppLauncher.exe or autopatch.exe</code>)</li>
        <li>Optional: <code class="font-mono">icon.ico</code> for SFX window & shortcuts</li>
      </ul>
    </section>

    <!-- Structure -->
    <section id="structure" class="mt-8">
      <h2 class="text-xl font-semibold">2) Prepare the Source Folder</h2>
      <div class="mt-3 rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/40 p-4">
        <pre class="overflow-x-auto text-sm leading-6 text-slate-800 dark:text-slate-100"><code class="font-mono">Package\
  AppLauncher.exe
  icon.ico              (optional)
  postinstall.vbs       (script below)</code></pre>
        <p class="mt-2 text-sm text-slate-600 dark:text-slate-400">Rename files as needed. The guide uses neutral names.</p>
      </div>
    </section>

    <!-- VBS -->
    <section id="vbs" class="mt-8">
      <h2 class="text-xl font-semibold">3) <span class="px-2 py-0.5 rounded-md bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-800 font-mono">postinstall.vbs</span> ‚Äî Create Shortcuts & Launch</h2>
      <p class="mt-2 text-slate-600 dark:text-slate-400">Save this file in the source folder.</p>
      <div class="relative mt-3 rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-900 text-slate-100">
        <button class="absolute top-2 right-2 text-xs border border-slate-700 hover:border-sky-400 rounded-md px-2 py-1" data-copy="#vbs-code">Copy</button>
<pre id="vbs-code" class="p-4 overflow-x-auto text-sm leading-6"><code class="font-mono">' Post-install: create shortcuts and launch application
Option Explicit
Dim WshShell, fso, instDir, scDesk, smDir, lnk
Set WshShell = CreateObject("WScript.Shell")
Set fso      = CreateObject("Scripting.FileSystemObject")

' Use the extracted folder (where this VBS is located)
instDir = fso.GetParentFolderName(WScript.ScriptFullName)

' Desktop shortcut
scDesk = WshShell.SpecialFolders("Desktop") & "\Your App.lnk"
Set lnk = WshShell.CreateShortcut(scDesk)
lnk.TargetPath = instDir & "\AppLauncher.exe"
lnk.WorkingDirectory = instDir
If fso.FileExists(instDir & "\icon.ico") Then lnk.IconLocation = instDir & "\icon.ico"
lnk.Save

' Start Menu shortcut
smDir = WshShell.SpecialFolders("Programs") & "\Your App"
If Not fso.FolderExists(smDir) Then fso.CreateFolder(smDir)
Set lnk = WshShell.CreateShortcut(smDir & "\Your App.lnk")
lnk.TargetPath = instDir & "\AppLauncher.exe"
lnk.WorkingDirectory = instDir
If fso.FileExists(instDir & "\icon.ico") Then lnk.IconLocation = instDir & "\icon.ico"
lnk.Save

' Auto launch application (optional)
WshShell.Run """" & instDir & "\AppLauncher.exe" & """", 1, False</code></pre>
      </div>
      <p class="mt-2 rounded-xl border border-slate-200 dark:border-slate-800 bg-sky-50/60 dark:bg-sky-500/10 text-slate-700 dark:text-slate-300 p-3">Replace <span class="font-semibold">Your App</span> and <span class="font-semibold">AppLauncher.exe</span> with your own names if needed.</p>
    </section>

    <!-- Build -->
    <section id="build" class="mt-8">
      <h2 class="text-xl font-semibold">4) Build the SFX in WinRAR</h2>
      <ol class="mt-2 list-decimal list-inside space-y-1 text-slate-700 dark:text-slate-300">
        <li>Open <span class="font-semibold">WinRAR</span> and browse into the <em>Package</em> folder.</li>
        <li>Select all files ‚Üí click <span class="px-1.5 py-0.5 rounded-md border border-slate-200 dark:border-slate-800 bg-slate-100 dark:bg-slate-800">Add</span>.</li>
        <li>In the dialog, set:
          <ul class="mt-1 list-disc list-inside ml-4 space-y-1">
            <li><span class="font-semibold">Archive format:</span> RAR</li>
            <li><span class="font-semibold">Create SFX archive:</span> checked</li>
            <li><span class="font-semibold">Advanced SFX options‚Ä¶ ‚Üí Text and icon ‚Üí Load SFX icon from file</span> ‚Üí choose <code class="font-mono">icon.ico</code> (optional)</li>
          </ul>
        </li>
        <li>Open the <span class="font-semibold">Comment</span> tab and paste <em>one</em> of the following blocks.</li>
      </ol>

      <h3 class="mt-4 font-semibold">A) Interactive Mode</h3>
      <div class="relative mt-2 rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-900 text-slate-100">
        <button class="absolute top-2 right-2 text-xs border border-slate-700 hover:border-sky-400 rounded-md px-2 py-1" data-copy="#cmt-a">Copy</button>
<pre id="cmt-a" class="p-4 overflow-x-auto text-sm leading-6"><code class="font-mono">;The comment below contains SFX script commands
Title=Application Installer
Path=%ProgramFiles%\Your App
Overwrite=1
Setup=wscript.exe postinstall.vbs</code></pre>
      </div>

      <h3 class="mt-4 font-semibold">B) Silent Mode</h3>
      <div class="relative mt-2 rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-900 text-slate-100">
        <button class="absolute top-2 right-2 text-xs border border-slate-700 hover:border-sky-400 rounded-md px-2 py-1" data-copy="#cmt-b">Copy</button>
<pre id="cmt-b" class="p-4 overflow-x-auto text-sm leading-6"><code class="font-mono">;The comment below contains SFX script commands
Title=Application Installer
Path=%ProgramFiles%\Your App
Silent=1
Overwrite=1
Setup=wscript.exe postinstall.vbs</code></pre>
      </div>

      <p class="mt-3 rounded-xl border border-slate-200 dark:border-slate-800 bg-sky-50/60 dark:bg-sky-500/10 text-slate-700 dark:text-slate-300 p-3">To avoid UAC, install per-user instead: <code class="font-mono">Path=%UserProfile%\Apps\Your App</code>.</p>
    </section>

    <!-- Test -->
    <section id="test" class="mt-8">
      <h2 class="text-xl font-semibold">5) Test</h2>
      <ul class="mt-2 list-disc list-inside space-y-1 text-slate-700 dark:text-slate-300">
        <li>Run the generated <span class="font-semibold">.exe</span> ‚Äî files extract to the specified folder.</li>
        <li>Shortcuts appear on Desktop and in Start Menu.</li>
        <li>The application auto-launches (remove the last VBS line if not desired).</li>
      </ul>
    </section>

    <!-- Troubleshooting -->
    <section id="troubleshoot" class="mt-8">
      <h2 class="text-xl font-semibold">6) Troubleshooting</h2>
      <ul class="mt-2 list-disc list-inside space-y-1 text-slate-700 dark:text-slate-300">
        <li><span class="font-semibold">Window title shows quotes</span> ‚Äî Use the WinRAR SFX comment format (no quotes). First line must be <code class="font-mono">;The comment below contains SFX script commands</code>.</li>
        <li><span class="font-semibold">Default folder isn‚Äôt Program Files</span> ‚Äî Use <code class="font-mono">Path=...</code> (WinRAR syntax). <code class="font-mono">InstallPath=</code> is 7-Zip SFX only.</li>
        <li><span class="font-semibold">VBS doesn‚Äôt run</span> ‚Äî Ensure Windows Script Host isn‚Äôt disabled by policy/AV.</li>
        <li><span class="font-semibold">No uninstaller</span> ‚Äî WinRAR SFX does not create one; remove by deleting the folder and shortcuts.</li>
      </ul>
    </section>

    <!-- Notes -->
    <section id="notes" class="mt-8">
      <h2 class="text-xl font-semibold">7) Notes & Options</h2>
      <ul class="mt-2 list-disc list-inside space-y-1 text-slate-700 dark:text-slate-300">
        <li><span class="font-semibold">RAR</span> is recommended for larger payloads.</li>
        <li><span class="font-semibold">Overwrite=1</span> ensures updates replace previous files.</li>
        <li><span class="font-semibold">Icon</span>: set SFX icon via <em>Advanced SFX options ‚Üí Text and icon</em>. Shortcuts use <code class="font-mono">icon.ico</code> from the install folder.</li>
        <li><span class="font-semibold">Split volumes</span>: configure <em>Split to volumes</em> in <em>Add to Archive‚Ä¶</em> for multi-part uploads.</li>
      </ul>
    </section>

    <!-- Checklist -->
    <section id="checklist" class="mt-8">
      <h2 class="text-xl font-semibold">8) Quick Checklist</h2>
      <div class="mt-3 rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/40 p-4">
        <ul class="list-disc list-inside space-y-1 text-slate-700 dark:text-slate-300">
          <li>Place <code class="font-mono">AppLauncher.exe</code>, <code class="font-mono">icon.ico</code>, and <code class="font-mono">postinstall.vbs</code> in the source folder.</li>
          <li>WinRAR ‚Üí Add ‚Üí check <span class="font-semibold">Create SFX archive</span> ‚Üí choose <span class="font-semibold">RAR5</span>.</li>
          <li><span class="font-semibold">Comment</span> tab ‚Üí paste the <code class="font-mono">Title/Path/Setup</code> block (no quotes).</li>
          <li>Build the <span class="font-semibold">.exe</span> ‚Üí test ‚Üí shortcuts + launch ready.</li>
        </ul>
      </div>
    </section>

  </main>

  <!-- FOOTER (identical to Color Tag Generator) -->
  <footer class="border-t border-slate-200 dark:border-slate-800">
    <div class="mx-auto max-w-[1080px] w-full px-4 md:px-6 lg:px-8">
      <div class="py-6 text-center text-sm text-slate-500">
        ¬© <span id="year"></span> DuaSelipar Dev Hub.
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script>
    // Theme toggle
    document.getElementById('themeToggle')?.addEventListener('click', () => {
      const root = document.documentElement;
      const isDark = root.classList.toggle('dark');
      try { localStorage.setItem('theme', isDark ? 'dark' : 'light'); } catch(e){}
    });

    // Year stamp
    document.getElementById('year').textContent = new Date().getFullYear();

    // Copy buttons
    document.querySelectorAll('[data-copy]').forEach(btn => {
      btn.addEventListener('click', () => {
        const sel = document.querySelector(btn.getAttribute('data-copy'));
        if(!sel) return;
        const text = sel.textContent;
        navigator.clipboard.writeText(text).then(()=>{
          const prev = btn.textContent; btn.textContent = 'Copied!';
          setTimeout(()=>{ btn.textContent = prev; }, 1200);
        });
      });
    });
  </script>
</body>
</html>
