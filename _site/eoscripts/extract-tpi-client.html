<!doctype html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#ffffff"/>
  <title>ðŸ“¦ QuickBMS Guide â€” Extract .tpi/.tpd</title>
  <meta name="description" content="Step-by-step guide to extract .tpi/.tpd client files using QuickBMS. Includes ready-to-use TQ_TPI_Pack.bms and RUN_TPI.bat with copy buttons.">

  <!-- Tailwind CDN only -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: { extend: { fontFamily: { sans: ['Inter','ui-sans-serif','system-ui','Segoe UI','Roboto','Helvetica','Arial'] } } }
    }
  </script>

  <!-- Prevent theme flash -->
  <script>
    (function(){
      try{
        const t = localStorage.getItem('theme');
        if (t === 'dark') document.documentElement.classList.add('dark');
        else if (t === 'light') document.documentElement.classList.remove('dark');
        else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches){
          document.documentElement.classList.add('dark');
        }
      }catch(e){}
    })();
  </script>
</head>
<body class="bg-white text-slate-800 dark:bg-slate-950 dark:text-slate-100 antialiased">

  <!-- Header (identical layout to Color Tag Generator) -->
  <header class="sticky top-0 z-40 bg-white/70 dark:bg-slate-950/70 backdrop-blur border-b border-slate-200/70 dark:border-slate-800/70">
    <div class="mx-auto max-w-[1080px] w-full px-4 md:px-6 lg:px-8">
      <div class="h-14 flex items-center justify-between">
        <h1 class="text-base md:text-lg font-extrabold tracking-tight">ðŸ“¦ Extract .tpi/.tpd (QuickBMS)</h1>
        <div class="flex items-center gap-2">
          <a href="/" class="hidden sm:inline-block text-sm font-semibold px-3 py-2 rounded-lg hover:bg-slate-950/5 dark:hover:bg-white/5">Home</a>
          <!-- Theme toggle -->
          <button id="themeToggle" class="inline-flex items-center justify-center h-9 w-9 rounded-lg ring-1 ring-slate-200 dark:ring-slate-800 hover:bg-slate-950/5 dark:hover:bg-white/5" title="Toggle theme">
            <!-- sun (shows in dark) -->
            <svg class="h-5 w-5 hidden dark:block" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="4"></circle>
              <path d="M12 2v2m0 16v2m10-10h-2M4 12H2m16.95 6.95-1.41-1.41M6.46 6.46 5.05 5.05m13.49 0-1.41 1.41M6.46 17.54l-1.41 1.41"/>
            </svg>
            <!-- moon (shows in light) -->
            <svg class="h-5 w-5 dark:hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Main -->
  <main class="mx-auto max-w-[1080px] w-full px-4 md:px-6 lg:px-8 py-8 pb-16">

    <!-- Hero -->
    <section class="rounded-2xl border border-slate-200 dark:border-slate-800 bg-gradient-to-tr from-sky-500/10 to-transparent p-6 md:p-8 mb-6">
      <h2 class="text-2xl md:text-3xl font-bold tracking-tight">Extract <span class="font-mono">.tpi/.tpd</span> Client Files</h2>
      <p class="mt-2 text-slate-600 dark:text-slate-400">
        Quick guide using QuickBMS. Includes <span class="font-mono">TQ_TPI_Pack.bms</span> and a batch runner to process all archives automatically.
      </p>
      <div class="mt-4 flex flex-wrap items-center gap-3">
        <a href="https://aluigi.altervista.org/quickbms.htm" class="inline-flex items-center gap-2 rounded-xl border border-slate-200 dark:border-slate-800 px-4 py-2 hover:border-sky-400" target="_blank" rel="noopener">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><path d="M14 3h7v7h-2V6.41l-9.29 9.3-1.42-1.42 9.3-9.29H14V3z"/><path d="M5 5h5V3H3v7h2V5zm0 14v-5H3v7h7v-2H5zm14 0h-5v2h7v-7h-2v5z"/></svg>
          <span class="font-semibold">Download QuickBMS</span>
        </a>
        <a href="#steps" class="inline-flex items-center gap-2 rounded-xl border border-slate-200 dark:border-slate-800 px-4 py-2 hover:border-sky-400">Jump to Tutorial</a>
      </div>
    </section>

    <!-- Steps -->
    <section id="steps" class="mt-6">
      <h3 class="text-xl font-semibold">Tutorial</h3>
      <ol class="mt-2 list-decimal list-inside space-y-2 text-slate-700 dark:text-slate-300">
        <li><b>Download</b> QuickBMS and extract it.</li>
        <li>Create <span class="font-mono">Input</span> and <span class="font-mono">Output</span> folders inside the QuickBMS directory.</li>
        <li>Save <span class="font-mono">TQ_TPI_Pack.bms</span> (script below) next to <span class="font-mono">quickbms.exe</span>.</li>
        <li>Save <span class="font-mono">RUN_TPI.bat</span> (batch below).</li>
        <li>Copy all client <span class="font-mono">.tpi/.tpd</span> files into <span class="font-mono">QuickBMS/Input</span>.</li>
        <li>Run <span class="font-mono">RUN_TPI.bat</span>.</li>
        <li>Extracted files will appear under <span class="font-mono">Output</span>.</li>
      </ol>
    </section>

    <!-- BMS Script -->
    <section class="mt-8">
      <h3 class="text-xl font-semibold">Script: <span class="font-mono">TQ_TPI_Pack.bms</span></h3>
      <div class="relative mt-3 rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-900 text-slate-100">
        <button class="absolute top-2 right-2 text-xs border border-slate-700 hover:border-sky-400 rounded-md px-2 py-1" data-copy="#bms">Copy</button>
        <pre id="bms" class="p-4 overflow-x-auto text-sm leading-6"><code class="font-mono"># NetDragon .tpi/.tpd extractor (QuickBMS)
# Reads .tpi (index) and extracts data from .tpd
# Place .tpi and .tpd together. If only .tpd exists, script tries direct read.

open FDDE tpi 0
open FDDE tpd 1

idstring "NetDragonDatPkg"
goto 0x24
get FILES long
get INFO_SIZE long
savepos INFO_OFF
math INFO_SIZE += INFO_OFF

for i = 0 &lt; FILES
    get NAME_OFF long
    get DATA_OFF long
    get SIZE long
    get ZSIZE long
    get FLAGS long
    get TIME long
    savepos CURR
    goto NAME_OFF
    get NAME string
    goto CURR
    if ZSIZE &gt; 0
        clog NAME DATA_OFF ZSIZE SIZE
    else
        log NAME DATA_OFF SIZE
    endif
next i
</code></pre>
      </div>
      <p class="mt-2 text-xs text-slate-500 dark:text-slate-400">If your client layout differs, adjust offsets/fields accordingly.</p>
    </section>

    <!-- RUN_TPI.BAT -->
    <section class="mt-8">
      <h3 class="text-xl font-semibold">Batch Runner: <span class="font-mono">RUN_TPI.bat</span></h3>
      <div class="relative mt-3 rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-900 text-slate-100">
        <button class="absolute top-2 right-2 text-xs border border-slate-700 hover:border-sky-400 rounded-md px-2 py-1" data-copy="#bat">Copy</button>
        <pre id="bat" class="p-4 overflow-x-auto text-sm leading-6"><code class="font-mono">@echo off
setlocal

REM === Paths ===
set "QUICKBMS=quickbms.exe"
set "BMS_SCRIPT=TQ_TPI_Pack.bms"
set "INPUT_DIR=Input"
set "OUTPUT_DIR=Output"

if not exist "%OUTPUT_DIR%" mkdir "%OUTPUT_DIR%"

echo [INFO] Scanning "%INPUT_DIR%" for .tpi/.tpd ...

REM 1) Process pairs by .tpi (index-driven)
for /r "%INPUT_DIR%" %%I in (*.tpi) do (
  set "IDX=%%~fI"
  set "NAME=%%~nI"
  if exist "%%~dpnI.tpd" (
    echo [RUN] %%~nxI + %%~nI.tpd
    "%QUICKBMS%" -o -Y "%BMS_SCRIPT%" "%%~fI" "%OUTPUT_DIR%\!NAME!" || echo [FAIL] %%~nxI
  ) else (
    echo [RUN] %%~nxI (no .tpd found; script may fallback)
    "%QUICKBMS%" -o -Y "%BMS_SCRIPT%" "%%~fI" "%OUTPUT_DIR%\!NAME!" || echo [FAIL] %%~nxI
  )
)

REM 2) Process lone .tpd (no matching .tpi)
for /r "%INPUT_DIR%" %%D in (*.tpd) do (
  if not exist "%%~dpnD.tpi" (
    echo [RUN] %%~nxD (tpd only)
    "%QUICKBMS%" -o -Y "%BMS_SCRIPT%" "%%~fD" "%OUTPUT_DIR%\%%~nD" || echo [FAIL] %%~nxD
  )
)

echo.
echo [DONE] Output: "%OUTPUT_DIR%"
pause</code></pre>
      </div>
    </section>

  </main>

  <!-- Footer (identical to Color Tag Generator) -->
  <footer class="border-t border-slate-200 dark:border-slate-800">
    <div class="mx-auto max-w-[1080px] w-full px-4 md:px-6 lg:px-8">
      <div class="py-6 text-center text-sm text-slate-500">
        Â© <span id="year"></span> DuaSelipar Dev Hub.
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script>
    // Theme toggle
    document.getElementById('themeToggle')?.addEventListener('click', () => {
      const root = document.documentElement;
      const isDark = root.classList.toggle('dark');
      try { localStorage.setItem('theme', isDark ? 'dark' : 'light'); } catch(e){}
    });
    document.getElementById('year').textContent = new Date().getFullYear();

    // Copy buttons
    document.querySelectorAll('[data-copy]').forEach((btn) => {
      btn.addEventListener('click', () => {
        const sel = document.querySelector(btn.getAttribute('data-copy'));
        if(!sel) return;
        const text = sel.textContent;
        navigator.clipboard.writeText(text).then(()=>{
          const prev = btn.textContent; btn.textContent = 'Copied!';
          setTimeout(()=>{ btn.textContent = prev; }, 1200);
        });
      });
    });
  </script>
</body>
</html>
